{"version":3,"sources":["src/js/util.js"],"names":["cnnutil","exports","Window","size","minsize","v","sum","prototype","add","x","push","length","xold","shift","get_average","reset","maxmin","w","maxv","minv","maxi","mini","i","dv","f2t","d","dd","Math","pow","floor","module"],"mappings":"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","file":"util.map","sourceRoot":"..","sourcesContent":["\r\n// contains various utility functions \r\nvar cnnutil = (function(exports){\r\n\r\n  // a window stores _size_ number of values\r\n  // and returns averages. Useful for keeping running\r\n  // track of validation or training accuracy during SGD\r\n  var Window = function(size, minsize) {\r\n    this.v = [];\r\n    this.size = typeof(size)==='undefined' ? 100 : size;\r\n    this.minsize = typeof(minsize)==='undefined' ? 20 : minsize;\r\n    this.sum = 0;\r\n  }\r\n  Window.prototype = {\r\n    add: function(x) {\r\n      this.v.push(x);\r\n      this.sum += x;\r\n      if(this.v.length>this.size) {\r\n        var xold = this.v.shift();\r\n        this.sum -= xold;\r\n      }\r\n    },\r\n    get_average: function() {\r\n      if(this.v.length < this.minsize) return -1;\r\n      else return this.sum/this.v.length;\r\n    },\r\n    reset: function(x) {\r\n      this.v = [];\r\n      this.sum = 0;\r\n    }\r\n  }\r\n\r\n  // returns min, max and indeces of an array\r\n  var maxmin = function(w) {\r\n    if(w.length === 0) { return {}; } // ... ;s\r\n\r\n    var maxv = w[0];\r\n    var minv = w[0];\r\n    var maxi = 0;\r\n    var mini = 0;\r\n    for(var i=1;i<w.length;i++) {\r\n      if(w[i] > maxv) { maxv = w[i]; maxi = i; } \r\n      if(w[i] < minv) { minv = w[i]; mini = i; } \r\n    }\r\n    return {maxi: maxi, maxv: maxv, mini: mini, minv: minv, dv:maxv-minv};\r\n  }\r\n\r\n  // returns string representation of float\r\n  // but truncated to length of d digits\r\n  var f2t = function(x, d) {\r\n    if(typeof(d)==='undefined') { var d = 5; }\r\n    var dd = 1.0 * Math.pow(10, d);\r\n    return '' + Math.floor(x*dd)/dd;\r\n  }\r\n\r\n  exports = exports || {};\r\n  exports.Window = Window;\r\n  exports.maxmin = maxmin;\r\n  exports.f2t = f2t;\r\n  return exports;\r\n\r\n})(typeof module != 'undefined' && module.exports);  // add exports to module.exports if in node.js\r\n\r\n\r\n"]}