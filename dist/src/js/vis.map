{"version":3,"sources":["src/js/vis.js"],"names":["cnnvis","exports","Graph","options","step_horizon","pts","maxy","miny","prototype","add","step","y","time","Date","getTime","push","drawSelf","canv","pad","H","height","W","width","ctx","getContext","clearRect","font","f2t","x","dd","Math","pow","floor","strokeStyle","beginPath","ng","i","xpos","moveTo","lineTo","fillText","ypos","stroke","N","length","t","s","tx","ty","p","pt","MultiGraph","legend","maxy_forced","miny_forced","numlines","styles","yl","n","k","fillStyle","module"],"mappings":"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","file":"vis.map","sourceRoot":"..","sourcesContent":["\r\n// contains various utility functions \r\nvar cnnvis = (function(exports){\r\n\r\n  // can be used to graph loss, or accuract over time\r\n  var Graph = function(options) {\r\n    var options = options || {};\r\n    this.step_horizon = options.step_horizon || 1000;\r\n    \r\n    this.pts = [];\r\n    \r\n    this.maxy = -9999;\r\n    this.miny = 9999;\r\n  }\r\n\r\n  Graph.prototype = {\r\n    // canv is the canvas we wish to update with this new datapoint\r\n    add: function(step, y) {\r\n      var time = new Date().getTime(); // in ms\r\n      if(y>this.maxy*0.99) this.maxy = y*1.05;\r\n      if(y<this.miny*1.01) this.miny = y*0.95;\r\n\r\n      this.pts.push({step: step, time: time, y: y});\r\n      if(step > this.step_horizon) this.step_horizon *= 2;\r\n    },\r\n    // elt is a canvas we wish to draw into\r\n    drawSelf: function(canv) {\r\n      \r\n      var pad = 25;\r\n      var H = canv.height;\r\n      var W = canv.width;\r\n      var ctx = canv.getContext('2d');\r\n\r\n      ctx.clearRect(0, 0, W, H);\r\n      ctx.font=\"10px Georgia\";\r\n\r\n      var f2t = function(x) {\r\n        var dd = 1.0 * Math.pow(10, 2);\r\n        return '' + Math.floor(x*dd)/dd;\r\n      }\r\n\r\n      // draw guidelines and values\r\n      ctx.strokeStyle = \"#999\";\r\n      ctx.beginPath();\r\n      var ng = 10;\r\n      for(var i=0;i<=ng;i++) {\r\n        var xpos = i/ng*(W-2*pad)+pad;\r\n        ctx.moveTo(xpos, pad);\r\n        ctx.lineTo(xpos, H-pad);\r\n        ctx.fillText(f2t(i/ng*this.step_horizon/1000)+'k',xpos,H-pad+14);\r\n      }\r\n      for(var i=0;i<=ng;i++) {\r\n        var ypos = i/ng*(H-2*pad)+pad;\r\n        ctx.moveTo(pad, ypos);\r\n        ctx.lineTo(W-pad, ypos);\r\n        ctx.fillText(f2t((ng-i)/ng*(this.maxy-this.miny) + this.miny), 0, ypos);\r\n      }\r\n      ctx.stroke();\r\n\r\n      var N = this.pts.length;\r\n      if(N<2) return;\r\n\r\n      // draw the actual curve\r\n      var t = function(x, y, s) {\r\n        var tx = x / s.step_horizon * (W-pad*2) + pad;\r\n        var ty = H - ((y-s.miny) / (s.maxy-s.miny) * (H-pad*2) + pad);\r\n        return {tx:tx, ty:ty}\r\n      }\r\n\r\n      ctx.strokeStyle = \"red\";\r\n      ctx.beginPath()\r\n      for(var i=0;i<N;i++) {\r\n        // draw line from i-1 to i\r\n        var p = this.pts[i];\r\n        var pt = t(p.step, p.y, this);\r\n        if(i===0) ctx.moveTo(pt.tx, pt.ty);\r\n        else ctx.lineTo(pt.tx, pt.ty);\r\n      }\r\n      ctx.stroke();\r\n    }\r\n  }\r\n\r\n  // same as graph but draws multiple lines. For now I'm lazy and duplicating\r\n  // the code, but in future I will merge these two more nicely.\r\n  var MultiGraph = function(legend, options) {\r\n    var options = options || {};\r\n    this.step_horizon = options.step_horizon || 1000;\r\n\r\n    if(typeof options.maxy !== 'undefined') this.maxy_forced = options.maxy;\r\n    if(typeof options.miny !== 'undefined') this.miny_forced = options.miny;\r\n\r\n    this.pts = [];\r\n    \r\n    this.maxy = -9999;\r\n    this.miny = 9999;\r\n    this.numlines = 0;\r\n\r\n    this.numlines = legend.length;\r\n    this.legend = legend;\r\n    this.styles = [\"red\", \"blue\", \"green\", \"black\", \"magenta\", \"cyan\", \"purple\", \"aqua\", \"olive\", \"lime\", \"navy\"];\r\n    // 17 basic colors: aqua, black, blue, fuchsia, gray, green, lime, maroon, navy, olive, orange, purple, red, silver, teal, white, and yellow\r\n  }\r\n\r\n  MultiGraph.prototype = {\r\n    // canv is the canvas we wish to update with this new datapoint\r\n    add: function(step, yl) {\r\n      var time = new Date().getTime(); // in ms\r\n      var n = yl.length;\r\n      for(var k=0;k<n;k++) {\r\n        var y = yl[k];\r\n        if(y>this.maxy*0.99) this.maxy = y*1.05;\r\n        if(y<this.miny*1.01) this.miny = y*0.95;\r\n      }\r\n\r\n      if(typeof this.maxy_forced !== 'undefined') this.maxy = this.maxy_forced;\r\n      if(typeof this.miny_forced !== 'undefined') this.miny = this.miny_forced;\r\n\r\n      this.pts.push({step: step, time: time, yl: yl});\r\n      if(step > this.step_horizon) this.step_horizon *= 2;\r\n    },\r\n    // elt is a canvas we wish to draw into\r\n    drawSelf: function(canv) {\r\n      \r\n      var pad = 25;\r\n      var H = canv.height;\r\n      var W = canv.width;\r\n      var ctx = canv.getContext('2d');\r\n\r\n      ctx.clearRect(0, 0, W, H);\r\n      ctx.font=\"10px Georgia\";\r\n\r\n      var f2t = function(x) {\r\n        var dd = 1.0 * Math.pow(10, 2);\r\n        return '' + Math.floor(x*dd)/dd;\r\n      }\r\n\r\n      // draw guidelines and values\r\n      ctx.strokeStyle = \"#999\";\r\n      ctx.beginPath();\r\n      var ng = 10;\r\n      for(var i=0;i<=ng;i++) {\r\n        var xpos = i/ng*(W-2*pad)+pad;\r\n        ctx.moveTo(xpos, pad);\r\n        ctx.lineTo(xpos, H-pad);\r\n        ctx.fillText(f2t(i/ng*this.step_horizon/1000)+'k',xpos,H-pad+14);\r\n      }\r\n      for(var i=0;i<=ng;i++) {\r\n        var ypos = i/ng*(H-2*pad)+pad;\r\n        ctx.moveTo(pad, ypos);\r\n        ctx.lineTo(W-pad, ypos);\r\n        ctx.fillText(f2t((ng-i)/ng*(this.maxy-this.miny) + this.miny), 0, ypos);\r\n      }\r\n      ctx.stroke();\r\n\r\n      var N = this.pts.length;\r\n      if(N<2) return;\r\n\r\n      // draw legend\r\n      for(var k=0;k<this.numlines;k++) {\r\n        ctx.fillStyle = this.styles[k % this.styles.length];\r\n        ctx.fillText(this.legend[k], W-pad-100, pad+20+k*16);\r\n      }\r\n      ctx.fillStyle = \"black\";\r\n\r\n      // draw the actual curve\r\n      var t = function(x, y, s) {\r\n        var tx = x / s.step_horizon * (W-pad*2) + pad;\r\n        var ty = H - ((y-s.miny) / (s.maxy-s.miny) * (H-pad*2) + pad);\r\n        return {tx:tx, ty:ty}\r\n      }\r\n      for(var k=0;k<this.numlines;k++) {\r\n\r\n        ctx.strokeStyle = this.styles[k % this.styles.length];\r\n        ctx.beginPath()\r\n        for(var i=0;i<N;i++) {\r\n          // draw line from i-1 to i\r\n          var p = this.pts[i];\r\n          var pt = t(p.step, p.yl[k], this);\r\n          if(i===0) ctx.moveTo(pt.tx, pt.ty);\r\n          else ctx.lineTo(pt.tx, pt.ty);\r\n        }\r\n        ctx.stroke();\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  exports = exports || {};\r\n  exports.Graph = Graph;\r\n  exports.MultiGraph = MultiGraph;\r\n  return exports;\r\n\r\n})(typeof module != 'undefined' && module.exports);  // add exports to module.exports if in node.js\r\n\r\n\r\n"]}